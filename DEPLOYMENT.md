# Инструкция по развертыванию Client и Server на разных компьютерах

## ⚡ Вариант 1: Облачный сервер на Render (рекомендуется)

Использование облачного сервера позволяет работать из любых сетей без настройки локального сервера.

### Настройка Client

1. Соберите .exe файл:
   ```powershell
   cd E:\frogy\client
   build.bat
   ```

2. Скопируйте на клиентский компьютер:
   - `dist/ScreenAI-Client.exe`
   - `client/config.json`

3. В `config.json` рядом с `.exe` укажите:
   ```json
   {
     "server_url": "https://screen-frog.onrender.com/process"
   }
   ```

4. Запустите `ScreenAI-Client.exe` — готово!

**Примечание**: Облачный сервер уже настроен на Render и принимает запросы. Telegram бот отвечает на `/start`.

---

## Вариант 2: Локальный сервер (для работы в одной сети)

## Требования
- **Server компьютер**: Python 3.x, FastAPI сервер
- **Client компьютер**: Windows (собранный .exe файл)

---

## Настройка Server (на втором компьютере)

### 1. Установка зависимостей
```powershell
cd E:\frogy\server
python -m pip install -r requirements.txt
```

### 2. Настройка config.json
Откройте `server/config.json` и убедитесь, что все ключи заполнены:
- `openai_key` - ключ OpenAI API
- `telegram_token` - токен Telegram бота
- `chat_id` - ID чата для отправки сообщений

### 3. Установка Tesseract OCR
- Установите Tesseract-OCR (если ещё не установлен)
- Убедитесь, что русский языковой пакет установлен

### 4. Запуск сервера
```powershell
cd E:\frogy\server
python -m uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

**Важно**: `--host 0.0.0.0` позволяет серверу принимать подключения с других компьютеров в сети.

### 5. Проверка IP адреса сервера
На серверном компьютере выполните:
```powershell
ipconfig
```
Найдите IP адрес (например, `192.168.1.100`)

### 6. Проверка файрвола
Убедитесь, что порт 8000 открыт в брандмауэре Windows:
```powershell
netsh advfirewall firewall add rule name="ScreenAI Server" dir=in action=allow protocol=TCP localport=8000
```

---

## Настройка Client (на первом компьютере)

### 1. Сборка .exe файла

На компьютере с исходным кодом:
```powershell
cd E:\frogy\client
build.bat
```

После сборки вы найдёте `ScreenAI-Client.exe` в папке `dist/`

### 2. Подготовка файлов для распространения

Скопируйте на клиентский компьютер:
- `dist/ScreenAI-Client.exe`
- `client/config.json` (из исходников)

**Важно**: `config.json` должен лежать **в той же папке**, что и `.exe` файл.

### 3. Настройка config.json для сетевого подключения

Откройте `config.json` рядом с `.exe` и укажите IP адрес серверного компьютера:
```json
{
  "server_url": "http://192.168.1.100:8000/process"
}
```

Замените `192.168.1.100` на реальный IP адрес вашего серверного компьютера.

### 4. Запуск клиента

Запустите `ScreenAI-Client.exe` (работает в фоновом режиме, без окна консоли).

### 5. Проверка работы

- Нажмите `Ctrl+Shift+X` для отправки скриншота
- Проверьте файл `client.log` (создаётся рядом с .exe) для просмотра логов

---

## Автозапуск Client при загрузке Windows

Чтобы клиент запускался автоматически при включении компьютера:

### Вариант 1: Через автозагрузку
1. Нажмите `Win+R`, введите `shell:startup`
2. Создайте ярлык на `ScreenAI-Client.exe` в этой папке

### Вариант 2: Через планировщик задач
1. Откройте Планировщик заданий Windows
2. Создайте задачу → "Запуск при входе в систему"
3. Действие: запуск программы `ScreenAI-Client.exe`

---

## Устранение неполадок

### Client не отправляет скриншоты

1. Проверьте `client.log` - там должны быть ошибки
2. Убедитесь, что `config.json` находится рядом с `.exe`
3. Проверьте IP адрес в `config.json` - он должен совпадать с IP сервера
4. Проверьте доступность сервера:
   ```powershell
   curl http://192.168.1.100:8000/docs
   ```

### Server не принимает подключения

1. Убедитесь, что сервер запущен и слушает на `0.0.0.0:8000`
2. Проверьте брандмауэр - порт 8000 должен быть открыт
3. Проверьте, что оба компьютера в одной сети

### Ошибки OCR

1. Убедитесь, что Tesseract-OCR установлен на серверном компьютере
2. Проверьте наличие русского языкового пакета (`rus.traineddata`)

---

## Примечания

- Клиент работает в фоновом режиме (`--noconsole`) - окна консоли не будет
- Все логи пишутся в `client.log` рядом с `.exe`
- Горячая клавиша: `Ctrl+Shift+X` для скриншота, `Esc` для выхода (но в фоновом режиме клиент может не реагировать на Esc)
- Для остановки клиента используйте Диспетчер задач Windows

